var root = {
	"name": "Multifaceted Specialist",
	"color": "silver",
		"children": [
			{
			"name": "Artist",
			"color": "#56222E",
			"children": [
				{
				"name": "Artist",
				"color": "#56222E",
				"children": [
					{"name": "Charcoal", "size": 1},
					{"name": "Oil Pastel", "size": 1},
					{"name": "Graphite", "size": 1},
					{"name": "Pencil", "size": 1},
					]
				},
				{
				"name": "Graphic Designer",
				"color": "#4D0036",
				"children": [
					{
					"name": "Designing",
					"children": [
						{"name": "Books", "size": 1},
		        {"name": "Newsletters", "size": 1},
		        {"name": "Posters", "size": 1},
		        {"name": "Banners", "size": 1},
		        {"name": "Fliers", "size": 1},
		        {"name": "Logos", "size": 1},
						{"name": "Motion Graphics", "size": 1},
						{"name": "Web Graphics", "size": 1}
						]
					},
					{
					"name": "Graphic Design Software",
					"children": [
						{"name": "Illustrator","size": 1},
						{"name": "InDesign", "size": 1},
						{"name": "Photoshop", "size": 1},
						{"name": "Flash", "size": 1},
						{"name": "AfterEffects", "size": 1},
						{"name": "Dreamweaver", "size": 1},
						{"name": "Bridge", "size": 1},
						{"name": "Acrobat", "size": 1}
						]
					},
					]
				},
				{
				"name": "Sound Designer",
				"color": "#7F406B",
				"children": [
					{"name": "Audtion","size": 1},
					{"name": "Logic Pro", "size": 1}
					]
				},
				{
				"name": "Photographer",
				"color": "#824648",
				"children": [
					{"name": "Photography",
					"children": [
						{"name": "Retouching", "size": 1},
						{"name": "Enhancing", "size": 1},
						{"name": "Photo Mainpulation", "size": 1},
						{"name": "Archiving", "size": 1},
						{"name": "Processing", "size": 1},
						{"name": "Producing", "size": 1}
						]
					},
					]
				},
				{
				"name": "Painter",
				"color": "#6C3433",
				"children": [
					{"name": "Watercolor", "size": 1},
					{"name": "Acrylic", "size": 1},
					{"name": "Oil", "size": 1}
					]
				},
				{
				"name": "Musician",
				"color": "#763344",
				"children": [
					{"name": "Trumpet", "size": 1},
					{"name": "Cello", "size": 1}
					]
				}
			]
			},
			{
			"name": "Computer Programmer",
			"color": "#632F5F",
			"children": [
				{
				"name": "Computer Programmer",
				"color": "#632F5F",
				"children": [
					{"name": "HTML/XHTML/HTML5", "size": 1},
					{"name": "CSS/CSS2/CSS3", "size": 1},
					{"name": "JavaScript (ES5/ES6)", "size": 1},
					{
					"name": "Tools",
					"color": "#632F5F",
					"children": [
						{"name": "Atom.io", "size": 1},
						{"name": "Brackets.io", "size": 1},
						{"name": "Notepad++", "size": 1},
						{"name": "Webstorm", "size": 1},
						{"name": "vim", "size": 1},
						{"name": "JIRA", "size": 1},
						{"name": "Git", "size": 1},
						{"name": "SVN", "size": 1},
						{"name": "Apache", "size": 1},
						{"name": "VirtualBox", "size": 1},
						]
					},
					{
					"name": "Data Formats",
					"size": 1,
					"children": [
						{"name": "CSV", "size": 1},
						{"name": "TSV", "size": 1},
						{"name": "JSON", "size": 1},
						{"name": "BSON", "size": 1},
						{"name": "XML", "size": 1}
					]
					},
					]
				},
				{
				"name": "Front-End Developer",
				"color": "#31252F",
				"children": [
					{
					"name": "Data Visualization Languages",
					"size": 1,
					"children": [
						{"name": "D3.js", "size": 1},
						{"name": "dc.js", "size": 1},
						{"name": "crossfilter.js", "size": 1},
						{"name": "nv.D3", "size": 1},
						{"name": "Google Charts", "size": 1}
					]},
					{
					"name": "Front-End Abstraction",
					"size": 1,
					"children": [
						{"name": "yeoman.io", "size": 1},
						{"name": "ionic.io", "size": 1},
						{"name": "angular.js", "size": 1},
						{"name": "express.js", "size": 1},
						{"name": "ember.js", "size": 1},
						{"name": "node.js", "size": 1},
						{"name": "MEAN.js", "size": 1},
						{"name": "moustache.js", "size": 1},
						{"name": "handlebars.js", "size": 1},
						{"name": "knockout.js", "size": 1},
						{"name": "meteor.js", "size": 1},
						{"name": "react.js", "size": 1},
						{"name": "flux", "size": 1},
						{"name": "redux", "size": 1},
						{"name": "Babel", "size": 1},
						{"name": "Grunt", "size": 1},
						{"name": "npm", "size": 1},
						{"name": "bower", "size": 1},
						{"name": "webpack", "size": 1},
					]},
					{
					"name": "jQuery",
					"size": 1,
					"children": [
						{"name": "jQuery UI", "size": 1},
						{"name": "jQuery Mobile", "size": 1}
					]
					},
					{
					"name": "Content Management Systems(CMS)",
					"size": 1,
					"children": [
						{"name": "WordPress", "size": 1},
						{"name": "Joomla", "size": 1},
						{"name": "phpBB", "size": 1}
					]
					},
					{"name": "HTML/XHTML/HTML5", "size": 1},
	        {"name": "CSS/CSS2/CSS3", "size": 1},
	        {"name": "JavaScript (ES5/ES6)", "size": 1},
					{"name": "Bootstrap", "size": 1},
					{"name": "AJAX", "size": 1}
				]
				},
				{
				"name": "Back-End Developer",
				"color": "#767281",
				"children": [
					{"name": "PHP", "size": 1},
					{
					"name": "Python",
					"size": 1,
					"children": [
						{"name": "Python", "size": 1},
						{"name": "Flask", "size": 1},
						{"name": "Tornado", "size": 1},
						{"name": "Django", "size": 1},
						{"name": "NLTK", "size": 1},
						{"name": "pip", "size": 1},
					]
					},
					{
					"name": "Groovy and Grails(GGTS)",
					"size": 1,
					"children": [
						{"name": "Groovy", "size": 1},
						{"name": "Grails", "size": 1},
						{"name": "GSP", "size": 1},
						{"name": "Gradle", "size": 1},
						{"name": "Spock", "size": 1},
					]
					},
					{
					"name": "Eclipse, J2EE",
					"size": 1,
					"children": [
						{"name": "Java", "size": 1},
						{"name": "JSP", "size": 1},
						{"name": "JUnit", "size": 1},
						{"name": "Maven", "size": 1},
						{"name": "Ant", "size": 1}
					]
					},
					{
					"name": "Spring(STS)",
					"size": 1,
					"children": [
						{"name": "Spring Framework", "size": 1},
						{"name": "Spring MVC", "size": 1},
						{"name": "Spring Security", "size": 1},
						{"name": "SpringSource TC Server", "size": 1},
						{"name": "Thymeleaf", "size": 1}
					]
					},
					{
					"name": "Databases",
					"size": 1,
					"children": [
						{"name": "Databases", "size": 1},
						{"name": "PostgresSQL", "size": 1},
						{"name": "MySQL", "size": 1},
						{"name": "Oracle", "size": 1},
						{"name": "Mongo DB", "size": 1},
						{"name": "Neo4j", "size": 1},
						{"name": "HQL", "size": 1},
						{"name": "SQL", "size": 1},
						{"name": "Cypher", "size": 1},
						{"name": "Hibernate", "size": 1},
					]
				},
					{
					"name": "DevOps",
					"size": 1,
					"children": [
						{"name": "DevOps", "size": 1},
						{"name": "Travis CI", "size": 1},
						{"name": "AWS", "size": 1},
						{"name": "Heroku", "size": 1},
						{"name": "TeamCity", "size": 1},
						{"name": "Sonarqube", "size": 1},
					]
				},
				{"name": "Machine Learning", "size": 1},
        {"name": "Affective Computing", "size": 1},
        {"name": "IoT", "size": 1},
        {"name": "Microservices", "size": 1},
				]
				}
			]
			},
			{
			"name": "Natural Scientist",
			"color": "#296A52",
			"children": [
				{
				"name": "Natural Scientist",
				"color": "#296A52",
				"children": [
					{"name": "Sciencing", "size": 1},
					{"name": "Observing", "size": 1},
					{"name": "Documenting", "size": 1},
					{"name": "Sharing", "size": 1},
					]
				},
				{
				"name": "Biologist",
				"color": "#348C35",
				"children": [
					{"name": "Sciencing", "size": 1},
					]
				},
				{
				"name": "Botanist",
				"color": "#101B13",
				"children": [
					{"name": "Sciencing", "size": 1},
					]
				},
			]
			},
			{
			"name": "Engineer",
			"color": "#775923",
			"children": [
				{
				"name": "Engineer",
				"color": "#775923",
				"children": [
					{"name": "Engineering", "size": 1},
					{"name": "Critical Thinking", "size": 1},
					{"name": "Decision Making", "size": 1},
					{"name": "Time Management", "size": 1},
					]
				},
				{
				"name": "Software Engineer",
				"color": "#795731",
				"children": [
					{"name": "Engineering", "size": 1},
					]
				},
				{
				"name": "Affective Engineer",
				"color": "#796950",
				"children": [
					{"name": "Engineering", "size": 1},
					]
				},
			]
			},
			{
			"name": "Social Scientist",
			"color": "#262561",
			"children": [
				{
				"name": "Social Scientist",
				"color": "#262561",
				"children": [
					{"name": "Analyzing", "size": 1},
					{"name": "Researching", "size": 1},
					{"name": "Writing", "size": 1},
					{"name": "Grant Writing", "size": 1},
					{"name": "Advocating", "size": 1}
					]
				},
				{
				"name": "Linguist",
				"color": "#606B81",
				"children": [
					{"name": "English", "size": 1},
					{"name": "German", "size": 1},
					{"name": "Spanish", "size": 1},
					{"name": "French", "size": 1},
					{"name": "Italian", "size": 1},
					{"name": "Swedish", "size": 1},
					{"name": "Portuguese", "size": 1},
					{"name": "Norwegian", "size": 1},
					{"name": "Russian", "size": 1},
					{"name": "Turkish", "size": 1},
					{"name": "Irish", "size": 1},
					{"name": "Danish", "size": 1},
					{"name": "Ukrainian", "size": 1},
					{"name": "Dutch", "size": 1},
					{"name": "Polish", "size": 1},
					{"name": "Catal√°n", "size": 1},
					{"name": "Welsh", "size": 1},
					{"name": "Esperanto", "size": 1},
					]
				},
				{
				"name": "Journalist",
				"color": "#412F6B",
				"children": [
					{"name": "Blogging", "size": 1},
					{"name": "Vlogging", "size": 1},
					{"name": "Interviewing", "size": 1},
					{"name": "Writing", "size": 1},
					{"name": "Documenting", "size": 1},
					{"name": "Researching", "size": 1},
					{"name": "Organization", "size": 1},
					{"name": "Planning", "size": 1}
					]
				},
				{
				"name": "World Historian",
				"color": "#181737",
				"children": [
					{"name": "Analyzing", "size": 1},
					{"name": "Researching", "size": 1},
					{"name": "Writing", "size": 1}
					]
				},
				{
				"name": "Political Economist",
				"color": "#181737",
				"children": [
					{"name": "Researching", "size": 1},
					{"name": "Grant Writing", "size": 1},
					{"name": "Advocating", "size": 1}
					]
				},
				{
				"name": "Cultural Anthropologist",
				"color": "#171449",
				"children": [
					{"name": "Analyzing", "size": 1},
					{"name": "Researching", "size": 1},
					{"name": "Writing", "size": 1}
					]
				},
				{
				"name": "Comparative Institutionalist",
				"color": "#3C5F7D",
				"children": [
					{"name": "Analyzing", "size": 1},
					{"name": "Researching", "size": 1},
					{"name": "Writing", "size": 1}
					]
				},
				{
				"name": "Social Activist",
				"color": "#44336A",
				"children": [
					{
					"name": "Campaigning",
					"children": [
						{"name": "Diplomacy", "size": 1},
						{"name": "Networking", "size": 1},
						{"name": "Negotiating", "size": 1},
						{"name": "Haggling", "size": 1},
						{"name": "Negotiating", "size": 1},
						{"name": "Debating", "size": 1}
					]
					},
					{
					"name": "Volunteering",
						"children": [
						{
						"name": "Advocating",
						"children": [
							{"name": "Supporting", "size": 1},
							{"name": "Mediating", "size": 1},
							{"name": "Preserving", "size": 1},
							{"name": "Negotiating", "size": 1}
						]
						},
						{"name": "Persevering", "size": 1},
						{"name": "Persuasion", "size": 1}
					]
					}
				]
				}
			]
			}

	]
}


function drawSunGraph(w, da, mobile) {

	var sunWidth = w,
	    sunHeight = 404,
	    radius = Math.min(sunWidth, sunHeight) / 2;

	var x = d3.scale.linear()
	    .range([0, 2 * Math.PI]);

	var y = d3.scale.sqrt()
	    .range([0, radius]);

	var color = d3.scale.category20c();

	var svg = d3.select("#navSunBurst").append("svg")
	    .attr("width", sunWidth)
	    .attr("height", sunHeight + 10 + da)
	  .append("g")
	    .attr("transform", "translate(" + sunWidth / 2 + "," + (sunHeight / 2 + 10) + ")");

	var partition = d3.layout.partition()
	    .value(function(d) { return d.size; });

	var arc = d3.svg.arc()
	    .startAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x))); })
	    .endAngle(function(d) { return Math.max(0, Math.min(2 * Math.PI, x(d.x + d.dx))); })
	    .innerRadius(function(d) { return Math.max(0, y(d.y)); })
	    .outerRadius(function(d) { return Math.max(0, y(d.y + d.dy)); });

	  var path = svg.selectAll("path")
	      .data(partition.nodes(root))
	    .enter().append("path")
	      .attr("d", arc)
		  .attr("stroke", "black")
		  .style("opacity", function(d) {
			  if(d.depth > 1){
			  	return 1/(d.depth-1);
			  }
			  else {
			  	return 1;
			  }
		  })
		  .style("fill", function(d) {
		  if(d.color != null){
			  return d.color;
			  } else if(d.parent != null) {
				  return d.parent.color ? d.parent.color: d.parent.parent.color;
				  } else {
				  return color((d.children ? d : d.parent).name);
				  }
		  })
	      .on("click", click)
		  .on("mouseenter", function(d) {
			  d3.select(this).style("fill", "darkGray");
			  })
		  .on("mouseover", function(d) {
			  d3.select("#skillFocus").html(function() {
					  return "<div style='margin-top: 80px'><span><img height='150' src='images/default-hex.png' alt='Nathaniel' /></span><br><h6 class='well'>" + d.name + "</h6></div>" ;
					});
				})
				// <
		  .on("mouseleave", function(d) {
			  d3.select(this)
			  .style("fill", function(d) {
			  if(d.color != null){
				  return d.color;
				  } else if(d.parent != null) {
					  return d.parent.color ? d.parent.color: d.parent.parent.color;
					  } else {
					  return color((d.children ? d : d.parent).name);
					  }
			  	  })
			  })
		  ;

	  function click(d) {
	    path.transition()
	      .duration(750)
	      .attrTween("d", arcTween(d));
		  d3.selectAll(".centerText")
		  .transition().duration(400)
		  .style("opacity", 0)
		  .style("font-size", "0px");
		  if(d.name == "Multifaceted Specialist"){
		  	d3.selectAll(".centerText")
			.style("display", "")
			.transition().duration(400)
			.style("opacity", 1)
			.style("font-size", "13px");
		  }
	  }


	d3.select(self.frameElement).style("height", sunHeight + "px");

	// Interpolate the scales!
	function arcTween(d) {
	  var xd = d3.interpolate(x.domain(), [d.x, d.x + d.dx]),
	      yd = d3.interpolate(y.domain(), [d.y, 1]),
	      yr = d3.interpolate(y.range(), [d.y ? 20 : 0, radius]);
	  return function(d, i) {
	    return i
	        ? function(t) { return arc(d); }
	        : function(t) { x.domain(xd(t)); y.domain(yd(t)).range(yr(t)); return arc(d); };
	  };
	}

	svg.append("text")
			.attr("class", "centerText")
	        .attr("x", (width / width))
	        .attr("y", -10 - (margin.top / margin.top))
	        .attr("text-anchor", "middle")
	        .style("font-size", "13px")
	        .text("Roles and Skills");

	svg.append("text")
			.attr("class", "centerText")
	        .attr("x", (width / width))
	        .attr("y", 10 - (margin.top / margin.top))
	        .attr("text-anchor", "middle")
	        .style("font-size", "13px")
	        .text("Distributed by");

	svg.append("text")
			.attr("class", "centerText")
	        .attr("x", (width / width))
	        .attr("y", 30 - (margin.top / margin.top))
	        .attr("text-anchor", "middle")
	        .style("font-size", "13px")
	        .text("Subject Area");

	svg.append("text")
			.attr("class", "centerText")
	        .attr("x", 0)
	        .attr("y", 170 + da - (margin.top / margin.top))
	        .attr("text-anchor", "middle")
	        .style("font-size", "13px")
	        .text("I've explored a few subjects.");

	svg.append("text")
			.attr("class", "centerText")
	        .attr("x", 0)
	        .attr("y", 190 + da - (margin.top / margin.top))
	        .attr("text-anchor", "middle")
	        .style("font-size", "13px")
	        .text("(Click an area to zoom)");
}

if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
	drawSunGraph(270, 0, true)
} else {
	drawSunGraph(780, 40, false)
}
